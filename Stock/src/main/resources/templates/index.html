<!DOCTYPE html>
<html lang="en"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="renderer" content="webkit"/>

    <title>进销存</title>

    <link href="/css/bootstrap.min.css?v=3.4.0" th:href="@{/css/bootstrap.min.css?v=3.4.0}" rel="stylesheet"/>
    <link href="/font-awesome/css/font-awesome.css?v=4.3.0" th:href="@{/font-awesome/css/font-awesome.css?v=4.3.0}" rel="stylesheet"/>

    <link href="/css/animate.css" th:href="@{/css/animate.css}" rel="stylesheet"/>
    <link href="/css/style.css?v=2.2.0" th:href="@{/css/style.css?v=2.2.0}" rel="stylesheet"/>
</head>
<body class="top-navigation">
    <div id="wrapper">
        <div id="page-wrapper" class="gray-bg">
            <div class="row border-bottom white-bg">
                <nav class="navbar navbar-static-top" role="navigation">
                    <div class="navbar-header">
                        <button aria-controls="navbar" aria-expanded="false" data-target="#navbar" data-toggle="collapse" class="navbar-toggle collapsed" type="button">
                            <i class="fa fa-reorder"></i>
                        </button>
                        <a href="/stock/index" class="navbar-brand">Stock</a>
                    </div>
                    <div class="navbar-collapse collapse" id="navbar">
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a aria-expanded="false" role="button" href="##" class="dropdown-toggle" data-toggle="dropdown">信息管理<span class="caret"></span></a>
                                <ul role="menu" class="dropdown-menu">
                                    <li><a href="/good/showGoodList">商品信息</a>
                                    </li>
                                    <li><a href="/good/showTypeList">商品类别信息</a>
                                    </li>
                                    <li><a href="/good/showUnitList">商品单位信息</a>
                                    </li>
                                    <li><a href="/user/showUserList">员工信息</a>
                                    </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a aria-expanded="false" role="button" href="##" class="dropdown-toggle" data-toggle="dropdown">仓库管理<span class="caret"></span></a>
                                <ul role="menu" class="dropdown-menu">
                                    <li><a href="/instock/showInStockList">入库单据</a>
                                    </li>
                                    <li><a href="/outstock/showOutStockList">出库单据</a>
                                    </li>
                                    <li><a href="/inventory/showInventoryList">盘点单据</a>
                                    </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a aria-expanded="false" role="button" href="##" class="dropdown-toggle" data-toggle="dropdown">分析统计<span class="caret"></span></a>
                                <ul role="menu" class="dropdown-menu">
                                    <li><a href="/reports/showReports">月季年报表</a>
                                    </li>
                                    <li><a href="/reports/showDetails">明细表</a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                        <ul class="nav navbar-top-links navbar-right">
                            <li>
								<!--<a href="login.html">
                                    <i class="fa fa-sign-out"></i> 退出
                                </a> -->
                                <span th:inline="text">
                                	Hello [[${#httpServletRequest.remoteUser}]]! 
                                	<form th:action="@{/logout}" method="post">
									   <button class="btn btn-primary btn-xs" type="submit">注销</button>
									</form>
                                </span>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>

            <div class="wrapper wrapper-content animated fadeInDown">
                <div class="container">
                <div class="row">
                        <div class="col-md-2">
                            <div class="ibox float-e-margins">
                                <div class="ibox-title">
                                    <span class="label label-success pull-right">种</span>
                                    <h5>商品</h5>
                                </div>
                                <div class="ibox-content">
                                    <h1 class="no-margins" th:text="${goodcount}">386,200</h1>
                                    <div class="stat-percent font-bold text-success">0<i class="fa fa-level-up"></i>
                                    </div>
                                    <small>新增商品</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="ibox float-e-margins">
                                <div class="ibox-title">
                                    <span class="label label-danger pull-right">种</span>
                                    <h5>库存</h5>
                                </div>
                                <div class="ibox-content">
                                    <h1 class="no-margins" th:text="${lessgoodcount}">80,800</h1>
                                    <div class="stat-percent font-bold text-danger"><i class="fa fa-warning"></i>
                                    </div>
                                    <small>库存不足</small>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="ibox float-e-margins">
                                <div class="ibox-title">
                                    <h5>单据</h5>
                                </div>
                                <div class="ibox-content">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <h1 class="no-margins" th:text="${instockcount}">406</h1>
                                            <div class="font-bold text-navy">入库/
                                            <small>单</small>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <h1 class="no-margins" th:text="${outstockcount}">206</h1>
                                            <div class="font-bold text-navy">出库/
                                            <small>单</small>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <h1 class="no-margins" th:text="${'&yen;'+ stockworth/100}">206</h1>
                                            <div class="font-bold text-navy">库存金额/
                                            <small>元</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="ibox float-e-margins">
                                <div class="ibox-title">
                                    <h5>数据统计</h5>
                                </div>
                                <div class="ibox-content">
                                    <div class="row">
                                        <div class="col-xs-4">
                                            <small class="stats-label">今日入库金额</small>
                                            <h3 id="todayInWorth" class="text-info">236 321.80</h3>
                                        </div>                                    
                                        <div class="col-xs-4">
                                            <small class="stats-label">今日出库金额</small>
                                            <h3 id="todayOutWorth" class="text-info">432.021</h3>
                                        </div>
                                        <div class="col-xs-4">
                                            <small class="stats-label">今日毛利</small>
                                            <h3 id="profit" class="text-info">46.11%</h3>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="ibox float-e-margins">
                                <div class="ibox-title">
                                    <h5>今日出入库详单</h5>
                                </div>
                                <div class="ibox-content">
                                    <div class="row">
                                        <div class="col-sm-9 m-b-xs font-bold text-navy">今日入库单</div>
                                    </div>
                                    <div class="table-responsive">
                                        <table class="table table-striped" id="todayInStock">
                                            <thead>
                                                <tr>
                                                    <th>单号</th>
                                                    <th>类型</th>
                                                    <th>商品</th>
                                                    <th>数量</th>
                                                    <th>金额</th>
                                                    <th>经办人</th>
                                                </tr>
                                            </thead>
                                            <tbody>
<!--                                             	<tr th:if="${todyInstockItems != null}">
                                            		<td colspan="6" align="center" class="text-danger">暂无入库</td>
                                            	</tr> -->
                                                <tr th:each="instockItem : ${todayInstockItems}" >
                                                	<td th:object="${instockItem.inStock}" th:text="*{id}">1234567890</td>
                                                	<td th:object="${instockItem.inStock}" th:text="*{type}">1234567890</td>
                                                	<td th:object="${instockItem.good}" th:text="*{name}">1234567890</td>
                                                	<td th:text="${instockItem.num}">1234567890</td>
                                                	<td th:text="${instockItem.worth/100}">1234567890</td>
                                                	<td th:object="${instockItem.inStock}" th:text="*{user.name}">1234567890</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <div class="row">
                                            <div class="col-sm-9 m-b-xs font-bold text-navy">今日出库单</div>
                                        </div>
                                        <table class="table table-striped" id="todayOutStock">
                                            <thead>
                                            <tr>
                                                <th>单号</th>
                                                <th>类型</th>
                                                <th>商品</th>
                                                <th>数量</th>
                                                <th>金额</th>
                                                <th>经办人</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            	<!-- <tr th:if="${todayOutstockItems != null}">
                                            		<td colspan="6" align="center" class="text-danger">暂无出库</td>
                                            	</tr> -->
                                            	<tr th:each="outstockItem,outstockItemStat : ${todayOutstockItems}" >
                                                	<td th:object="${outstockItem.outStock}" th:text="*{id}">1234567890</td>
                                                	<td th:object="${outstockItem.outStock}" th:text="*{type}">1234567890</td>
                                                	<td th:object="${outstockItem.good}" th:text="*{name}">1234567890</td>
                                                	<td th:text="${outstockItem.num}">1234567890</td>
                                                	<td th:text="${outstockItem.worth/100}">1234567890</td>
                                                	<td th:object="${outstockItem.outStock}" th:text="*{user.name}">1234567890</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>

                </div>

            </div>
            <div class="footer">
                <div>
                    <strong>Copyright</strong> MYH &copy; 2016
                </div>
            </div>

		</div>
	</div>

    <!-- Mainly scripts -->
    <script th:src="@{/js/jquery-3.1.0.min.js}"></script>
    <script th:src="@{/js/bootstrap.min.js?v=3.4.0}"></script>
    <script th:src="@{/js/plugins/metisMenu/jquery.metisMenu.js}"></script>
    <script th:src="@{/js/plugins/slimscroll/jquery.slimscroll.min.js}"></script>


    <!-- Custom and plugin javascript -->
    <script th:src="@{/js/hplus.js?v=2.2.0}"></script>
    <script th:src="@{/js/plugins/pace/pace.min.js}"></script>


    <!-- Page-Level Scripts -->
    <script type="text/javascript">
    $(document).ready(function () {
    	var todayInWorth = 0;
    	var todayOutWorth = 0;
    	
    	console.log($('#todayInStock tr').length);
    	console.log($('#todayOutStock tr').length);
    	if($('#todayInStock tr').length == 1){
    		var trHTML = '<tr><td colspan="6" align="center" class="text-danger">暂无入库</td></tr>'
    		$("#todayInStock").append(trHTML);
    	}
    	if($('#todayOutStock tr').length == 1){
    		var trHTML = '<tr><td colspan="6" align="center" class="text-danger">暂无出库</td></tr>'
    		$("#todayOutStock").append(trHTML);
    	}
    	
    	$('#todayInStock').find('tr').each(function () {  
            $(this).find('td:eq(4)').each(function () {  
            	todayInWorth += parseFloat($(this).text()) ;  
            })  
    	});
    	$('#todayOutStock').find('tr').each(function () {  
            $(this).find('td:eq(4)').each(function () {  
            	todayOutWorth += parseFloat($(this).text()) ;  
            })  
    	});
    	
    	$("#todayInWorth").text("¥"+todayInWorth);
    	$("#todayOutWorth").text("¥"+todayOutWorth);
    	$("#profit").text("¥"+(todayOutWorth-todayInWorth));
    });
    </script>
</body>
</html>